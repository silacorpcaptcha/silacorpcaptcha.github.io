<?php
// Start der Sitzung
session_start();

// Überprüfen, ob der Cookie bereits vorhanden ist
if(isset($_COOKIE['verification']) && $_COOKIE['verification'] === 'verified') {
    // Weiterleitung, wenn der Benutzer bereits verifiziert wurde
    header("Location: http://silacorpupdateserver.github.io/redirectcaptcha.html");
    exit();
}

// Überprüfen, ob das Formular abgesendet wurde
if(isset($_POST['submit'])) {
    // Überprüfen, ob der eingegebene Text korrekt ist
    if($_POST['verification_text'] === 'I am not a bot') {
        // Cookie setzen, wenn die Verifizierung erfolgreich ist
        setcookie('verification', 'verified', time() + (86400 * 30), "/"); // Gültig für 30 Tage
        // Weiterleitung nach erfolgreicher Verifizierung
        header("Location: http://massageapi.duckdns.org/redirectcaptcha.html");
        exit();
    } else {
        // Fehlermeldung anzeigen, wenn der Text falsch eingegeben wurde
        echo "<p>Der eingegebene Text ist falsch. Bitte versuchen Sie es erneut.</p>";
    }
}
?>

<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verifizierung</title>
</head>
<body>
    <h1>Verifizierung</h1>
    <p>Bitte schreiben Sie den folgenden Text ab, um zu bestätigen, dass Sie kein Bot sind:</p>
    <p><strong>I am not a bot</strong></p>
    <form method="post" action="">
        <label for="verification_text">Geben Sie den Text ein:</label><br>
        <input type="text" id="verification_text" name="verification_text" required><br><br>
        <input type="submit" name="submit" value="Absenden">
    </form>
</body>
</html>
